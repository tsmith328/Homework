
public class MergeSorter extends AbstractSorter {

    public MergeSorter(Comparable[] arr) {
        super(arr);
    }

    public void sortArray() {
        int len = array.length;
        if (len <= 1) {
            return;
        }
        Comparable[] left, right;
        int mid = Math.round(len / 2);
        left = new Comparable[mid];
        right = new Comparable[len - mid];
        for (int i = 0; i < mid; i++) {
            left[i] = array[i];
        }
        for (int j = mid; j < len; j++) {
            right[mid - j] = array[j];
        }

        AbstractSorter leftSorter = new MergeSorter(left);
        AbstractSorter rightSorter = new MergeSorter(right);
        leftSorter.sortArray();
        rightSorter.sortArray();
        array = merge(leftSorter.getArray(),rightSorter.getArray());
    }

    private static Comparable[] removeFirst(Comparable[] old) {
        Comparable[] newArr = new Comparable[old.length - 1];
        for (int i = 1; i < old.length; i++) {
            newArr[i - 1] = old[i];
        }
        return newArr;
    }

    private static Comparable[] merge(Comparable[] left, Comparable[] right) {
        Comparable[] finished;
        int pos = 0;
        while (left.length > 0 || right.length > 0) {
            if (left.length > 0 && right.length > 0) {
                if left[0].compareTo(right[0] <= 0) {
                    finished[pos] = left[0];
                    pos++;
                    left = removeFirst(left);
                } else {
                    finished[pos] = right[0];
                    pos++;
                    right = removeFirst(right);
                }
            } else if (left.length > 0) {
                finished[pos] = left[0];
                pos++;
                left = removeFirst(left);
            } else if (right.length > 0) {
                finished[pos] = right[0];
                pos++;
                right = removeFirst(right);
            }
        }
        return finished;
    }
}
